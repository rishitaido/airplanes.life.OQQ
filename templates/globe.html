<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Airport Explorer (MapLibre v5)</title>

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <script src='https://unpkg.com/maplibre-gl@5.6.0/dist/maplibre-gl.js'></script>
  <link rel='stylesheet' href='https://unpkg.com/maplibre-gl@5.6.0/dist/maplibre-gl.css' />

  <script>
    window.MAPTILER_KEY = "{{ maptiler_key }}";
  </script>

  <script type="module" src="{{ url_for('static', filename='maplibre.js') }}"></script>
  <script type="module" src="{{ url_for('static', filename='globe-tools.js') }}"></script>
</head>

<body class="page-map">

  <!-- Header -->
  <header class="subheader-map">
    <a class="btn-dark" href="{{ url_for('index') }}">‚Üê Back to Home</a>
    <button id="toggle-view" class="btn-dark">Switch to Flat Map</button>
    <button id="toggle-airports" class="btn-dark">Hide Airports</button>
    <button id="toggle-restaurants" class="btn-dark">Show Restaurants</button>
    <button id="toggle-attractions" class="btn-dark">Show Attractions</button>
    <input id="globe-search" placeholder="Search IATA / city"
           style="width: 220px; padding: 0.4rem 0.6rem; border-radius: 6px; border: 1px solid #ccc;" />
  </header>

  <!-- Map -->
  <div id="map"></div>

  <!-- Itinerary Sidebar -->
  <aside id="map-sidebar" class="map-sidebar">
    <h3 onclick="document.getElementById('map-sidebar').classList.toggle('collapsed')">
      Your Itinerary <span style="font-size:1rem;">‚ñº</span>
    </h3>
    <div id="sticky-itinerary"></div>
  </aside>

  <!-- AI Chat Floating Button -->
  <button id="ai-map-chat" class="floating-chat">üí¨</button>

  <!-- AI Chat Box -->
  <div id="map-chat-box" class="chat-box hidden">
    <div class="chat-box-header">
      AI Assistant
      <button onclick="document.getElementById('map-chat-box').classList.add('hidden')" style="background:none;border:none;font-size:1.2rem;cursor:pointer;">&times;</button>
    </div>
    <textarea id="map-chat-input" placeholder="Ask about an address..."></textarea>
    <button id="map-chat-send">Send</button>
    <div id="map-chat-response"></div>
  </div>

</body>
</html>
